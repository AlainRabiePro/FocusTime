# ğŸ”§ Maintenance et extension du systÃ¨me d'erreurs

## Vue d'ensemble du systÃ¨me

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Utilisateur voit un message d'erreur                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                     â”‚\n                     â–¼\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚  getErrorMessage(error)    â”‚\n        â”‚  (utils/error-handler.ts)  â”‚\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                     â”‚\n         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n         â”‚           â”‚           â”‚\n         â–¼           â–¼           â–¼\n    Traduction  VÃ©rification  Message\n    du code      partielle    gÃ©nÃ©rique\n    exact                      \n     â”‚           â”‚           â”‚\n     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n             â”‚\n             â–¼\n    Message en franÃ§ais\n    comprÃ©hensible\n```\n\n## ğŸ¯ Ajouter une nouvelle traduction d'erreur\n\n### Ã‰tape 1 : Identifier le code d'erreur\n\nQuand vous rencontrez une nouvelle erreur, vÃ©rifiez :\n- Le `error.code` (ex: `auth/user-not-found`)\n- Le `error.message` contient-il une piste ?\n- Consultez la documentation Firebase\n\n### Ã‰tape 2 : Ouvrir le fichier\n\n```bash\nutils/error-handler.ts\n```\n\n### Ã‰tape 3 : Ajouter la traduction\n\n```typescript\nconst authErrorMap: { [key: string]: string } = {\n  // ... erreurs existantes ...\n  \n  // Nouvelle erreur\n  'auth/nouveau-code': 'Votre message en franÃ§ais',\n};\n```\n\n### Ã‰tape 4 : Tester\n\n1. Faire en sorte que l'erreur se produise\n2. VÃ©rifier que le message franÃ§ais s'affiche\n3. VÃ©rifier dans la console que l'erreur complÃ¨te est loggÃ©e\n\n## ğŸ“Š Ajouter des erreurs par catÃ©gorie\n\n### Authentification Firebase\n\n```typescript\n// Erreurs de connexion\n'auth/user-not-found': 'Cet e-mail n\\'existe pas...',\n'auth/wrong-password': 'Le mot de passe est incorrect...',\n\n// Erreurs d'inscription\n'auth/email-already-in-use': 'Cet e-mail est dÃ©jÃ  utilisÃ©...',\n'auth/weak-password': 'Le mot de passe doit contenir...',\n\n// Erreurs de rÃ©seau\n'auth/network-request-failed': 'ProblÃ¨me de connexion...',\n'auth/too-many-requests': 'Trop de tentatives...',\n```\n\n### Firestore (Base de donnÃ©es)\n\n```typescript\n'permission-denied': 'Vous n\\'avez pas l\\'accÃ¨s...',\n'not-found': 'La ressource n\\'a pas pu Ãªtre trouvÃ©e...',\n'already-exists': 'Cette ressource existe dÃ©jÃ ...',\n'unavailable': 'Le service n\\'est pas disponible...',\n```\n\n### Erreurs personnalisÃ©es\n\n```typescript\n'custom/my-error': 'Mon message en franÃ§ais',\n'validation/invalid-input': 'L\\'entrÃ©e n\\'est pas valide...',\n```\n\n## ğŸ” DÃ©boguer les erreurs non gÃ©rÃ©es\n\n### Cas 1 : Erreur affichÃ©e en anglais\n\n```typescript\n// âŒ ProblÃ¨me\nAlert.alert('Erreur', 'Firebase: Error (auth/unknown-error).');\n\n// âœ… Solution\nAlert.alert('âš ï¸ Erreur', getErrorMessage(error));\n\n// ğŸ“ VÃ©rifier\n1. Ajouter le code dans authErrorMap\n2. Ou attendre que la vÃ©rification partielle le capture\n```\n\n### Cas 2 : Message gÃ©nÃ©rique au lieu de spÃ©cifique\n\n```typescript\n// Console log\nconsole.log('Error code:', error.code); // 'auth/new-error-code'\n\n// Ajouter la traduction\nauthErrorMap['auth/new-error-code'] = 'Message spÃ©cifique';\n```\n\n### Cas 3 : Erreur ne venant pas de Firebase\n\n```typescript\n// Erreur custom\nthrow new Error('Ceci est dÃ©jÃ  en franÃ§ais');\n\n// getErrorMessage() retournera le string directement\nconst message = getErrorMessage('Ceci est dÃ©jÃ  en franÃ§ais'); // âœ… OK\n```\n\n## ğŸ“ˆ Ajouter une nouvelle langue\n\n### Refactoriser pour supporter plusieurs langues\n\n```typescript\n// CrÃ©er un systÃ¨me de langue\ntype Language = 'fr' | 'en' | 'es';\n\nconst errorMessages: { [key in Language]: { [key: string]: string } } = {\n  fr: {\n    'auth/user-not-found': 'Cet e-mail n\\'existe pas...',\n    // ...\n  },\n  en: {\n    'auth/user-not-found': 'Email not found...',\n    // ...\n  },\n  es: {\n    'auth/user-not-found': 'Email no encontrado...',\n    // ...\n  },\n};\n\nexport const getErrorMessage = (error: any, lang: Language = 'fr'): string => {\n  const errorCode = error.code || error.message || '';\n  return errorMessages[lang][errorCode] || 'Une erreur s\\'est produite.';\n};\n```\n\n## ğŸ” Bonnes pratiques\n\n### âœ… Ã€ FAIRE\n\n```typescript\n// 1. Toujours utiliser getErrorMessage()\nAlert.alert('âš ï¸ Erreur', getErrorMessage(error));\n\n// 2. Logger l'erreur complÃ¨te\nconsole.error('Full error:', error);\n\n// 3. Fournir un contexte\nconsole.error('Error in saveTask:', error);\n\n// 4. Utiliser des emojis cohÃ©rents\nAlert.alert('âœ… SuccÃ¨s', message);\nAlert.alert('âš ï¸ Erreur', message);\n\n// 5. Ajouter des conseils pratiques\n'ProblÃ¨me de connexion. VÃ©rifiez votre rÃ©seau.'\n```\n\n### âŒ Ã€ Ã‰VITER\n\n```typescript\n// 1. Afficher error.message directement\nAlert.alert('Erreur', error.message); // âŒ Peut Ãªtre en anglais\n\n// 2. Afficher error.code\nAlert.alert('Erreur', error.code); // âŒ 'auth/network-request-failed'\n\n// 3. Ne pas logger pour le debug\n// ... pas de console.error\n\n// 4. Messages gÃ©nÃ©riques\n'Une erreur s\\'est produite.' // âŒ Pas assez spÃ©cifique\n\n// 5. Oublier les emojis\nAlert.alert('Erreur', message); // âŒ Pas de emoji\n```\n\n## ğŸ“‹ Checklist pour chaque nouvelle erreur\n\n- [ ] Code d'erreur identifiÃ©\n- [ ] Message franÃ§ais rÃ©digÃ©\n- [ ] Traduction ajoutÃ©e dans authErrorMap\n- [ ] Message testÃ© et validÃ©\n- [ ] Ã‰moji appropriÃ© utilisÃ©\n- [ ] Documentation mise Ã  jour\n\n## ğŸš€ Performance et optimisation\n\n### ConsidÃ©rations\n\n1. **ImmuabilitÃ©** : authErrorMap ne change jamais aprÃ¨s initialisation\n2. **VÃ©rification rapide** : Map lookup en O(1)\n3. **Fallback** : VÃ©rification partielle (includes) en O(n) seulement si nÃ©cessaire\n4. **Pas de regex** : Pas d'overhead de compilation regex\n\n### Mesures\n\n```typescript\n// Avant\nAlert.alert('Erreur', error.message); // Temps : negligible\n\n// AprÃ¨s\nAlert.alert('âš ï¸ Erreur', getErrorMessage(error)); // Temps : negligible + traduction\n```\n\n## ğŸ“¦ Versionning et releases\n\n### Quand mettre Ã  jour la version\n\n```typescript\n// utils/error-handler.ts\nconst VERSION = '1.1.0'; // Bump pour chaque ajout de traduction\n```\n\n### Changelog\n\n```markdown\n## v1.1.0 - [Date]\n- Ajout de traductions pour auth/custom-error\n- AmÃ©lioration du message rÃ©seau\n- Support pour erreurs Firestore supplÃ©mentaires\n\n## v1.0.0 - 11 fÃ©vrier 2026\n- Version initiale\n- 15 traductions d'erreurs Firebase\n```\n\n## ğŸ”— IntÃ©gration CI/CD\n\n### Tester les traductions\n\n```bash\n#!/bin/bash\n# test-errors.sh\n\n# VÃ©rifier que toutes les traductions sont en franÃ§ais\n# (pas de caractÃ¨res ASCII < 128 sauf les caractÃ¨res standard)\n\ngrep -n \"'auth/\" utils/error-handler.ts | while read line; do\n  if [[ ! $line =~ [Ã Ã¢Ã¤Ã¡Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Å“Ã¦Ã§Ã€Ã‚Ã„ÃÃ‰ÃˆÃŠÃ‹ÃÃÃ”Ã™Ã›ÃœÅ’Ã†Ã‡] ]]; then\n    echo \"âš ï¸ Attention: $line ne semble pas en franÃ§ais\"\n  fi\ndone\n```\n\n## ğŸ“ Support et troubleshooting\n\n### Q : Une erreur n'est pas traduite\n**R :** Ajouter le code d'erreur dans `authErrorMap` avec sa traduction\n\n### Q : L'erreur s'affiche en anglais au lieu du franÃ§ais\n**R :** VÃ©rifier que `getErrorMessage()` est utilisÃ©, pas `error.message`\n\n### Q : Besoin d'ajouter une erreur custom\n**R :** Simplement lancer `throw new Error('Message en franÃ§ais')`\n\n### Q : OÃ¹ logger les erreurs pour le debug ?\n**R :** Toujours utiliser `console.error('Context:', error)` en plus du message utilisateur\n\n---\n\n**Maintenu par** : Ã‰quipe de dÃ©veloppement\n**DerniÃ¨re mise Ã  jour** : 11 fÃ©vrier 2026\n**Support** : Voir ERROR_HANDLING.md pour plus de dÃ©tails\n